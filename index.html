<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Khipu 360</title>
    <script src="https://aframe.io/releases/0.6.1/aframe.min.js"></script>
    <script src="scripts/aframe-gif-shader.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
	<!-- 360 images. -->
	<img id="image-medialab" src="images/360/medialab.jpg">
	<img id="image-rooftop" src="images/360/rooftop.jpg">

	<!-- Teleport. -->
	<img id="img-teleport" src="images/teleport.png">
	<!-- Character images -->
	<img id="anap-front" src="images/characters/anap_front.png">
	<img id="anao-front" src="images/characters/anao_front.png">
	<img id="coni-front" src="images/characters/coni_front.png">
	<img id="danie-front" src="images/characters/danie_front.png">
	
	<img id="anap-side" src="images/characters/anap_side.png">
	<img id="anao-side" src="images/characters/anao_side.png">
	<img id="coni-side" src="images/characters/coni_side.png">
	<img id="danie-side" src="images/characters/danie_side.png">

	<img id="khipukamayuq-front" src="images/characters/khipukamayuq_front.png">

	<!-- Models. -->
	<a-asset-item id="amulet-model" src="models/amulet/amulet_1set.glb"></a-asset-item>
	<!-- Background audios. -->
	<audio id="audio-background-scene2" src="audios/background/scene2.mp3"></audio>	
	<audio id="audio-background-scene3" src="audios/background/scene3.mp3"></audio>
	<!-- Sound effects. -->
	<audio id="audio-effect-scene2" src="audios/effects/scene2-door.mp3"></audio>
	<!-- Narrative audios. -->
	<audio id="audio-narrative-scene3" src="audios/narrative/scene3.mp3"></audio>
	<!-- Character audios. -->
	<audio id="audio-khipukamayuq" src="audios/characters/khipukamayuq.mp3"></audio>
      </a-assets>

      <a-camera id="camera" wasd-controls-enabled="true"
		position="0 0 4.5">
        <a-cursor id="cursor">
          <a-animation begin="click" easing="ease-in"
		       attribute="scale" fill="backwards" from="0.1
		       0.1 0.1" to="1 1 1" dur="150">
	  </a-animation>
          <a-animation begin="cursor-fusing" easing="ease-in"
		       attribute="scale" from="1 1 1" to="0.1 0.1 0.1"
		       dur="1500">
	  </a-animation>
        </a-cursor>
      </a-camera>

      <!-- Scene 2. -->
      <a-sky id="sky-medialab" radius="5" src="#image-medialab"
	     rotation="0 -90 0"
	     visible="true">
      </a-sky>
      <a-sound id="sound-background-scene2" src="#audio-background-scene2"
	       autoplay="true"
	       position="-3 -1 5">
	<a-animation attribute="volume"
		     dur="5000" from="1" to="0.1"
		     begin="background-sound-reduce-volume">
	</a-animation>
      </a-sound>
      <!-- Characters. -->
      <a-image id="image-anao-scene2" src="#anao-front" position="1 0 -1.75"
	       height="2.5" width="0.75"
	       visible="true">
	<a-animation attribute="position"
		     to="2 -1 0"
		     begin="walk"
		     dur="3000">
	</a-animation>
	<a-animation attribute="height"
		     to="4"
		     begin="walk"
		     dur="3000">
	</a-animation>
	<a-animation attribute="width"
		     to="1.25"
		     begin="walk"
		     dur="3000">
	</a-animation>
      </a-image>	
      <a-image id="image-anap-scene2" src="#anap-front" position="1.25 0 -0.75"
	       height="2.5" width="0.75"
	       visible="true">
	<a-animation attribute="position"
		     to="1 -1 0"
		     begin="walk"
		     dur="3000">
	</a-animation>
	<a-animation attribute="height"
		     to="4"
		     begin="walk"
		     dur="3000">
	</a-animation>
	<a-animation attribute="width"
		     to="1.25"
		     begin="walk"
		     dur="3000">
	</a-animation>
      </a-image>
      <a-image id="image-coni-scene2" src="#coni-front" position="-0.75 0 -1.5"
	       height="2" width="0.75"
	       visible="true">
	<a-animation attribute="position"
		     to="0 -1 0"
		     begin="walk"
		     dur="3000">
	</a-animation>	  
	<a-animation attribute="height"
		     to="4"
		     begin="walk"
		     dur="3000">
	</a-animation>
	<a-animation attribute="width"
		     to="1.25"
		     begin="walk"
		     dur="3000">
	</a-animation>
      </a-image>
      <a-image id="image-danie-scene2" src="#danie-front" position="-2 0 1"
	       height="2" width="0.75"
	       visible="true">
	<a-animation attribute="position"
		     to="-1 -1 0"
		     begin="walk"
		     dur="3000">
	</a-animation>
	<a-animation attribute="height"
		     to="4"
		     begin="walk"
		     dur="3000">
	</a-animation>
	<a-animation attribute="width"
		     to="1.25"
		     begin="walk"
		     dur="3000">
	</a-animation>		  
      </a-image>
      <!-- Teleport. -->
      <a-entity id="teleport-scene2" transparent="true">
	<a-image  src="#img-teleport"
		  position="3.5 0.5 0"
		  rotation="0 70 0" 
		  opacity="0">
	  <a-animation id="animation-door-delay" attribute="opacity"
		       to="0" dur="3000">
	  </a-animation>
	  <a-animation id="animation-door" attribute="opacity"
		       delay="3000" dur="3000" to="1">
	  </a-animation>			
	</a-image> 
	<a-sound id="sound-effect-scene2" src="#audio-effect-scene2"
		 autoplay="false">
	</a-sound>
      </a-entity>

      <!--a-entity id="gif-anao-walk" position="1 0 7" geometry="primitive: plane; height: 4; width: 1.5"
		material="shader: gif; src:url(gifs/anao_walk.gif); transparent: true; autoplay: true"
		visible="true">
	<a-animation attribute="position"
		     to="1 0 11"
		     begin="walk"
		     dur="3000">
	</a-animation>
      </a-entity-->

      <!-- Scene 3. -->
      <a-sky id="sky-rooftop" radius="10" src="#image-rooftop"
	     rotation="0 -95 0"
	     visible="false">
      </a-sky>
      <a-sound id="sound-background-scene3" src="#audio-background-scene3"
	       autoplay="false"
	       position="-3 -1 2">
	<a-animation attribute="volume"
		     dur="3000" from="0" to="1"
		     begin="start"Â¨>
	</a-animation>		
	<a-animation attribute="volume"
		     dur="5000" from="1" to="0.1"
		     begin="background-sound-reduce-volume">
	</a-animation>
	<a-animation attribute="volume"
		     dur="5000" from="0.1" to="1"
		     begin="background-sound-raise-volume">
	</a-animation>	
      </a-sound>
      <!-- Characters. -->
      <a-image id="image-anao-scene3" src="#anao-side" position="2 0 -2"
	       height="3" width="1"
	       rotation="0 -90 0"
	       visible="false">
      </a-image>	
      <a-image id="image-anap-scene3" src="#anap-side" position="2 0 -1"
	       height="3" width="1"
	       rotation="0 -100 0"
	       visible="false">
      </a-image>
      <a-image id="image-coni-scene3" src="#coni-side" position="-2 0 -2"
	       height="3" width="1"
	       rotation="0 -80 0"
	       visible="false">
      </a-image>
      <a-image id="image-danie-scene3" src="#danie-side" position="-2 0 -1"
	       height="3" width="1"
	       rotation="0 -70 0"
	       visible="false">
      </a-image>
      <a-image id="khipukamayuq" src="#khipukamayuq-front" position="0 5 -5"
	       height="3" width="1"
	       opacity="0">
	<a-animation id="animation-khipukamayuq" attribute="opacity"
		     begin="start" delay="5000" dur="5000" to="1">
        </a-animation>	
	<a-animation id="animation-khipukamayuq-delay" attribute="opacity"
		     begin="start" dur="5000" to="0">
        </a-animation>	
	<a-sound id="sound-khipukamayuq" src="#audio-khipukamayuq"
		 autoplay="false">
	</a-sound>
      </a-image>
      <!-- Teleport. -->
      <a-entity id="amulet" gltf-model="#amulet-model"
		position="0 4.5 -4.5" scale="0 0 0" rotation="90 0 360"
		visible="true">
	<a-animation id="amulet-delay" attribute="scale" to="0 0 0"
		     begin="amulet-appears-started" dur="20000">
	</a-animation>
	<a-animation id="amulet-appears" attribute="scale" to="0.2 0.2 0.2"
		     begin="amulet-delay-ended">
	</a-animation>
	<a-animation id="amulet-decends" attribute="position" to="0 1 -1.5"
		     begin="amulet-appears-ended" dur="3000">
	</a-animation>
      </a-entity>
      <!-- Narrative. -->
      <a-entity>
	<a-sound id="sound-narrative-scene3" src="#audio-narrative-scene3"
		 autoplay="false">
      </a-entity>
     
    </a-scene>
    
    <script src="scripts/controller.js"></script>    
  </body>
</html>
